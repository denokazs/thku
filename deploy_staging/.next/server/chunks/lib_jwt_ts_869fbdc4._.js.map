{"version":3,"sources":["../../../lib/jwt.ts"],"sourcesContent":["import { SignJWT, jwtVerify } from 'jose';\r\n\r\nconst SECRET_KEY = process.env.JWT_SECRET || 'super-secret-key-change-this-in-prod-please';\r\nconst key = new TextEncoder().encode(SECRET_KEY);\r\n\r\nexport async function signJWT(payload: any, expiresIn: string = '24h') {\r\n    return await new SignJWT(payload)\r\n        .setProtectedHeader({ alg: 'HS256' })\r\n        .setIssuedAt()\r\n        .setExpirationTime(expiresIn)\r\n        .sign(key);\r\n}\r\n\r\nexport async function verifyJWT(token: string) {\r\n    try {\r\n        const { payload } = await jwtVerify(token, key);\r\n        return payload;\r\n    } catch (error) {\r\n        return null;\r\n    }\r\n}\r\n"],"names":[],"mappings":"uCAAA,IAAA,EAAA,EAAA,CAAA,CAAA,OAAA,EAAA,EAAA,CAAA,CAAA,MAEA,IAAM,EAAa,QAAQ,GAAG,CAAC,UAAU,EAAI,8CACvC,EAAM,IAAI,cAAc,MAAM,CAAC,GAE9B,eAAe,EAAQ,CAAY,CAAE,EAAoB,KAAK,EACjE,OAAO,MAAM,IAAI,EAAA,OAAO,CAAC,GACpB,kBAAkB,CAAC,CAAE,IAAK,OAAQ,GAClC,WAAW,GACX,iBAAiB,CAAC,GAClB,IAAI,CAAC,EACd,CAEO,eAAe,EAAU,CAAa,EACzC,GAAI,CACA,GAAM,SAAE,CAAO,CAAE,CAAG,MAAM,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,EAAO,GAC3C,OAAO,CACX,CAAE,MAAO,EAAO,CACZ,OAAO,IACX,CACJ"}