module.exports=[78497,e=>{"use strict";var n=e.i(27957),t=e.i(9939),i=e.i(93458),a=e.i(49632);let s=new TextEncoder().encode(process.env.JWT_SECRET||"your-secret-key-change-this-in-production-min-32-chars"),r="admin-token";async function o(e){let n=process.env.ADMIN_PASSWORD_HASH;return n?a.default.compare(e,n):(console.warn("ADMIN_PASSWORD_HASH not set! Using fallback password check."),e===(process.env.ADMIN_PASSWORD||"admin123"))}async function c(){return await new n.SignJWT({isAdmin:!0}).setProtectedHeader({alg:"HS256"}).setIssuedAt().setExpirationTime("7d").sign(s)}async function u(e){try{return(await (0,t.jwtVerify)(e,s)).payload}catch(e){return null}}async function d(e){(await (0,i.cookies)()).set(r,e,{httpOnly:!0,secure:!0,sameSite:"lax",maxAge:604800,path:"/"})}async function l(){(await (0,i.cookies)()).delete(r)}async function A(){let e=(await (0,i.cookies)()).get(r);return e?.value||null}async function m(){let e=await A();if(!e)return!1;let n=await u(e);return n?.isAdmin===!0}async function y(e){return a.default.hash(e,10)}e.s(["createAdminToken",()=>c,"getAdminToken",()=>A,"hashPassword",()=>y,"removeAdminCookie",()=>l,"setAdminCookie",()=>d,"verifyAdminAuth",()=>m,"verifyAdminPassword",()=>o,"verifyAdminToken",()=>u])}];

//# sourceMappingURL=lib_admin-auth_ts_85588a11._.js.map