module.exports=[18622,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},24725,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},70406,(e,t,r)=>{t.exports=e.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},93695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},14747,(e,t,r)=>{t.exports=e.x("path",()=>require("path"))},24361,(e,t,r)=>{t.exports=e.x("util",()=>require("util"))},54799,(e,t,r)=>{t.exports=e.x("crypto",()=>require("crypto"))},22734,(e,t,r)=>{t.exports=e.x("fs",()=>require("fs"))},62294,e=>{"use strict";let t,r;e.i(22734),e.i(14747).default.join(process.cwd(),"data","thk.db");let s={host:process.env.DB_HOST||"localhost",user:process.env.DB_USER||"root",password:process.env.DB_PASS||"",database:process.env.DB_NAME||"thk_db",waitForConnections:!0,connectionLimit:10,queueLimit:0};try{t=e.r(22244)}catch(e){}try{let e=Error("Cannot find module 'better-sqlite3'");throw e.code="MODULE_NOT_FOUND",e}catch(e){}function a(){if(!t)throw Error("mysql2 driver not found");return r||(r=t.createPool(s)),r}let n=e=>{try{if("object"==typeof e)return e;return e?JSON.parse(e):[]}catch(e){return[]}},o=e=>"string"==typeof e?e:JSON.stringify(e||[]),i={users:{table:"users",json:"users",type:"array"},clubs:{table:"clubs",json:"clubs",type:"array",jsonFields:["president","gallery","badges","socialMedia"]},events:{table:"events",json:"events",type:"array",jsonFields:["images","schedule","speakers","faq"],boolFields:["isPast","isFeatured"]},announcements:{table:"announcements",json:"announcements",type:"array"},news:{table:"news",json:"news",type:"array"},confessions:{table:"confessions",json:"confessions",type:"array"},comments:{table:"comments",json:"comments",type:"array"},messages:{table:"messages",json:"messages",type:"array",jsonFields:["internalNotes"]},forumPosts:{table:"forum_posts",json:"forumPosts",type:"array",jsonFields:["likes","comments"]},members:{table:"members",json:"members",type:"array"},shuttleStops:{table:"shuttle_stops",json:"shuttleStops",type:"array"},cafeteriaMenu:{table:"cafeteria_menu",json:"cafeteriaMenu",type:"object",key:"date"},settings:{table:"settings",json:"settings",type:"kv"}};async function l(e){return c(e)}async function p(e){return y(e)}async function c(e){let t=a(),r={};for(let s of e||Object.keys(i)){if(!i[s])continue;let e=i[s];try{if("array"===e.type){let[s]=await t.query(`SELECT * FROM ${e.table}`);r[e.json]=s.map(t=>{let r={...t};return e.jsonFields&&e.jsonFields.forEach(e=>{r[e]&&(r[e]=n(r[e]))}),e.boolFields&&e.boolFields.forEach(e=>r[e]=!!r[e]),r})}else if("kv"===e.type){let[s]=await t.query(`SELECT * FROM ${e.table}`),a={};s.forEach(e=>{try{a[e.key]=JSON.parse(e.value)}catch{a[e.key]=e.value}}),r[e.json]=a.site_settings||a}else if("object"===e.type){let[s]=await t.query(`SELECT * FROM ${e.table}`),a={};s.forEach(t=>{a[t[e.key]]=t}),r[e.json]=a}}catch(t){console.error(`Error fetching ${s}:`,t.message),r[e.json]="array"===e.type?[]:{}}}return r}async function y(e){let t=a(),r=await t.getConnection();try{for(let t in await r.beginTransaction(),i){let s=i[t],a=e[s.json];if(a){if("array"===s.type){if(!Array.isArray(a)||(await r.query(`DELETE FROM ${s.table}`),0===a.length))continue;let[e]=await r.query(`SHOW COLUMNS FROM ${s.table}`),t=e.map(e=>e.Field);if(0===t.length)continue;let n=t.map(()=>"?").join(", "),i=t.map(e=>`\`${e}\``).join(", "),l=`INSERT INTO ${s.table} (${i}) VALUES (${n})`;for(let e of a){let a={...e};s.jsonFields&&s.jsonFields.forEach(e=>a[e]=o(a[e])),s.boolFields&&s.boolFields.forEach(e=>a[e]=+!!a[e]);let n=t.map(e=>void 0===a[e]?null:a[e]);await r.query(l,n)}}else if("kv"===s.type){let e=JSON.stringify(a);await r.query(`REPLACE INTO ${s.table} (\`key\`, value) VALUES (?, ?)`,["site_settings",e])}else if("object"===s.type){let[e]=await r.query(`SHOW COLUMNS FROM ${s.table}`),t=e.map(e=>e.Field),n=t.map(()=>"?").join(", "),o=t.map(e=>`\`${e}\``).join(", "),i=`INSERT INTO ${s.table} (${o}) VALUES (${n})`;for(let e in await r.query(`DELETE FROM ${s.table}`),a){let n={...a[e],[s.key]:e},o=t.map(e=>void 0===n[e]?null:n[e]);await r.query(i,o)}}}}await r.commit()}catch(e){throw await r.rollback(),e}finally{r.release()}}e.s(["readDb",()=>l,"writeDb",()=>p])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__55a1d30f._.js.map